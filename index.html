<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯›å­©æ™ºèƒ½é£²é£Ÿç®¡å®¶ ğŸ¾</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF9A9E;
            --primary-dark: #fa7e83;
            --secondary: #FECFEF;
            --accent: #a1c4fd;
            --text: #5D5D5D;
            --bg: #FFF0F3;
            --card-bg: #FFFFFF;
        }

        body {
            font-family: 'Quicksand', 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(#ffdde1 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Changed for longer content */
            min-height: 100vh;
            margin: 0;
            padding: 40px 20px;
        }

        .container {
            background: var(--card-bg);
            padding: 2.5rem;
            border-radius: 35px;
            box-shadow: 0 15px 35px rgba(255, 154, 158, 0.15);
            max-width: 480px;
            width: 100%;
            border: 5px solid white;
            position: relative;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-size: 1.8rem;
        }
        
        .subtitle {
            text-align: center;
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 1.5rem;
        }

        /* Pet Switcher */
        .pet-toggle {
            display: flex;
            background: #f0f0f0;
            border-radius: 50px;
            padding: 5px;
            margin-bottom: 25px;
            position: relative;
        }

        .pet-toggle input {
            display: none;
        }

        .pet-toggle label {
            flex: 1;
            text-align: center;
            padding: 10px;
            z-index: 2;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            color: #aaa;
            border-radius: 50px;
        }

        .pet-toggle input:checked + label {
            color: white;
        }

        .slider {
            position: absolute;
            height: calc(100% - 10px);
            width: calc(50% - 5px);
            background: var(--primary);
            border-radius: 50px;
            top: 5px;
            left: 5px;
            transition: 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 1;
        }

        #cat:checked ~ .slider {
            transform: translateX(100%);
            background: var(--accent);
        }

        /* Forms */
        .section-title {
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        select, input {
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 10px;
            border: 2px solid var(--secondary);
            border-radius: 15px;
            font-size: 1rem;
            font-family: inherit;
            background: white;
            transition: 0.3s;
            box-sizing: border-box;
            outline: none;
            color: var(--text);
        }

        select:focus, input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 154, 158, 0.2);
        }

        .input-group {
            position: relative;
        }
        
        .input-suffix {
            position: absolute;
            right: 15px;
            top: 14px;
            color: #999;
            font-size: 0.9rem;
            pointer-events: none;
        }

        button.calc-btn {
            background: linear-gradient(45deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 16px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 1.5rem;
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.4);
            transition: transform 0.2s;
        }

        button.calc-btn:active {
            transform: scale(0.98);
        }

        /* Results */
        #result-card {
            background: linear-gradient(135deg, #fff5f7 0%, #fff 100%);
            border: 2px solid var(--secondary);
            padding: 20px;
            border-radius: 25px;
            margin-top: 25px;
            display: none;
            animation: slideUp 0.5s ease;
        }

        .main-result {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px dashed var(--secondary);
            padding-bottom: 15px;
        }

        .big-number {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
        }

        .unit {
            font-size: 1rem;
            color: #888;
        }

        .meal-plan {
            display: flex;
            justify-content: space-around;
            text-align: center;
        }

        .plan-item {
            background: white;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            flex: 1;
            margin: 0 5px;
        }

        .plan-title {
            font-size: 0.8rem;
            color: #999;
            margin-bottom: 5px;
        }

        .plan-val {
            font-weight: bold;
            color: var(--text);
            font-size: 1.1rem;
        }

        /* Advice Section */
        .advice-box {
            margin-top: 25px;
            background: #F0F7FF;
            padding: 15px;
            border-radius: 15px;
            border-left: 5px solid var(--accent);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .advice-title {
            font-weight: bold;
            color: #5B86E5;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive tweaks */
        @media (max-width: 400px) {
            .container { padding: 1.5rem; }
            .big-number { font-size: 2.5rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>æ¯›å­©é£²é£Ÿç®¡å®¶ ğŸ¾</h1>
        <p class="subtitle">é¸æ“‡å“ç¨®èˆ‡é£¼æ–™ï¼Œä¸€éµè¨ˆç®—å»ºè­°é£Ÿé‡</p>

        <!-- Pet Switcher -->
        <div class="pet-toggle">
            <input type="radio" id="dog" name="petType" value="dog" checked onchange="initData()">
            <label for="dog">ğŸ¶ ç‹—ç‹—</label>
            <input type="radio" id="cat" name="petType" value="cat" onchange="initData()">
            <label for="cat">ğŸ± è²“å’ª</label>
            <div class="slider"></div>
        </div>

        <!-- Input Fields -->
        <div>
            <div class="section-title">ğŸ§¬ å“ç¨® (å”åŠ©é å¡«é«”é‡)</div>
            <select id="breedSelect" onchange="updateWeightFromBreed()">
                <option value="">-- è«‹é¸æ“‡å“ç¨® --</option>
            </select>

            <div class="section-title">âš–ï¸ é«”é‡ (kg)</div>
            <div class="input-group">
                <input type="number" id="weight" placeholder="è¼¸å…¥å¯¦éš›é«”é‡" step="0.1">
                <span class="input-suffix">kg</span>
            </div>

            <div class="section-title">ğŸƒ ç”Ÿæ´»å‹æ…‹</div>
            <select id="condition">
                <!-- Populated by JS -->
            </select>

            <div class="section-title">ğŸ¥« é¸æ“‡é£¼æ–™å“ç‰Œ</div>
            <select id="foodBrand" onchange="updateCaloriesFromBrand()">
                <option value="0">-- æ‰‹å‹•è¼¸å…¥æˆ–é¸æ“‡å“ç‰Œ --</option>
                <!-- Populated by JS -->
            </select>

            <div class="section-title">ğŸ”¥ ç†±é‡ (kcal/kg)</div>
            <div class="input-group">
                <input type="number" id="calories" placeholder="åŒ…è£èƒŒé¢çš„ä»£è¬èƒ½(ME)">
                <span class="input-suffix">kcal/kg</span>
            </div>
        </div>

        <button class="calc-btn" onclick="calculate()">é–‹å§‹è¨ˆç®— âœ¨</button>

        <!-- Results -->
        <div id="result-card">
            <div class="main-result">
                <div style="margin-bottom:5px; font-size:0.9rem; color:#888;">å»ºè­°æ¯æ—¥ç¸½é‡</div>
                <span class="big-number" id="totalAmount">0</span>
                <span class="unit">g (å…¬å…‹)</span>
                <div style="font-size: 0.8rem; color: var(--primary); margin-top: 5px;" id="totalKcal"></div>
            </div>

            <div class="meal-plan">
                <div class="plan-item">
                    <div class="plan-title">æ—©æ™šå…©é¤</div>
                    <div class="plan-val"><span id="meal2">0</span> g / é¤</div>
                </div>
                <div class="plan-item">
                    <div class="plan-title">å°‘é‡ä¸‰é¤</div>
                    <div class="plan-val"><span id="meal3">0</span> g / é¤</div>
                </div>
            </div>

            <div class="advice-box">
                <div class="advice-title">ğŸ’¡ ç¸é†«å°å®åš€</div>
                <div id="adviceText">è¨ˆç®—çµæœåƒ…ä¾›åƒè€ƒï¼Œè«‹ä¾ç…§æ¯›å­©é«”æ…‹(BCS)èª¿æ•´ã€‚æ›é£¼æ–™è«‹éµå¾ªã€Œ7æ—¥æ›é£Ÿæ³•ã€é¿å…è»Ÿä¾¿å–”ï¼</div>
            </div>
        </div>
    </div>

    <script>
        // --- Data Database ---
        const data = {
            dog: {
                breeds: [
                    { name: "ç±³å…‹æ–¯ (ä¸­å‹)", weight: 15 },
                    { name: "è²´è³“çŠ¬ (ç©å…·å‹)", weight: 3 },
                    { name: "æŸ´çŠ¬", weight: 9 },
                    { name: "é»ƒé‡‘çµçŠ¬", weight: 30 },
                    { name: "æ‹‰ä¸æ‹‰å¤š", weight: 32 },
                    { name: "æŸ¯åŸº", weight: 12 },
                    { name: "æ³•é¬¥", weight: 11 },
                    { name: "åšç¾", weight: 2.5 },
                    { name: "å‰å¨ƒå¨ƒ", weight: 2 },
                    { name: "å“ˆå£«å¥‡", weight: 23 },
                    { name: "é‚Šå¢ƒç‰§ç¾ŠçŠ¬", weight: 18 },
                    { name: "æ¯”ç†Š", weight: 5 }
                ],
                conditions: [
                    { val: 1.6, text: "æˆçŠ¬ (å·²çµç´®/ä¸€èˆ¬)" },
                    { val: 1.8, text: "æˆçŠ¬ (æœªçµç´®)" },
                    { val: 3.0, text: "å¹¼çŠ¬ (4å€‹æœˆä»¥ä¸‹)" },
                    { val: 2.0, text: "å¹¼çŠ¬ (æˆé•·ä¸­)" },
                    { val: 1.0, text: "æ¸›é‡ä¸­ / è€çŠ¬" },
                    { val: 1.2, text: "æ´»å‹•é‡æ¥µä½" },
                    { val: 2.0, text: "å·¥ä½œçŠ¬ / é«˜æ´»å‹•é‡" }
                ],
                foods: [
                    { name: "çš‡å®¶ (Royal Canin) å°å‹æˆçŠ¬", kcal: 3960 },
                    { name: "çš‡å®¶ (Royal Canin) ä¸­å‹æˆçŠ¬", kcal: 3840 },
                    { name: "Orijen (æ¸´æœ›) åŸå‘³é®®é›", kcal: 3960 },
                    { name: "Orijen (æ¸´æœ›) å…­ç¨®é­š", kcal: 3860 },
                    { name: "Hill's (å¸Œçˆ¾æ€) æˆçŠ¬", kcal: 3650 },
                    { name: "Real Power (ç‘å¨) 1è™Ÿè‰åŸç¾Š", kcal: 4050 },
                    { name: "ZiwiPeak (å·”å³°) ç¾Šè‚‰è‚‰ä¹¾", kcal: 5600 },
                    { name: "Acana (æ„›è‚¯æ‹¿) å–®ä¸€è›‹ç™½é´¨è‚‰", kcal: 3393 },
                    { name: "ç´é “ (Nutram) T23 ç«é›", kcal: 3725 }
                ]
            },
            cat: {
                breeds: [
                    { name: "ç±³å…‹æ–¯ (ä¸€èˆ¬)", weight: 4.5 },
                    { name: "ç¾åœ‹çŸ­æ¯›è²“", weight: 5 },
                    { name: "è‹±åœ‹çŸ­æ¯›è²“", weight: 5.5 },
                    { name: "å¸ƒå¶è²“", weight: 6.5 },
                    { name: "æ³¢æ–¯è²“", weight: 4 },
                    { name: "æ›¼èµ¤è‚¯ (çŸ­è…¿)", weight: 3.5 },
                    { name: "æš¹ç¾…è²“", weight: 3.5 },
                    { name: "ç·¬å› è²“", weight: 7.5 }
                ],
                conditions: [
                    { val: 1.2, text: "æˆè²“ (å·²çµç´®/å®¤å…§)" },
                    { val: 1.4, text: "æˆè²“ (æœªçµç´®/æ´»èº)" },
                    { val: 2.5, text: "å¹¼è²“ (æˆé•·ä¸­)" },
                    { val: 0.8, text: "æ¸›é‡ä¸­ / èƒ–èƒ–è²“" },
                    { val: 1.0, text: "è€è²“ (æ´»å‹•åŠ›ä½)" },
                    { val: 1.6, text: "æ‡·å­• / å“ºä¹³æœŸ" }
                ],
                foods: [
                    { name: "çš‡å®¶ (Royal Canin) å®¤å…§è²“", kcal: 3750 },
                    { name: "çš‡å®¶ (Royal Canin) æ³Œå°¿é“é…æ–¹", kcal: 3870 },
                    { name: "Orijen (æ¸´æœ›) é®®é›æ„›è²“", kcal: 4060 },
                    { name: "Orijen (æ¸´æœ›) å…­ç¨®é­š", kcal: 4060 },
                    { name: "Real Power (ç‘å¨) 3è™Ÿæµ·é­š", kcal: 4150 },
                    { name: "Wellness CORE ç„¡ç©€æˆè²“", kcal: 3977 },
                    { name: "è«æ¯” (Mobby) ç„¡ç©€é¹¿è‚‰", kcal: 3650 },
                    { name: "ç´é “ (Nutram) T22 ç„¡ç©€ç«é›", kcal: 3820 },
                    { name: "æ€ªç¸éƒ¨è½ 98% é®®è‚‰ç³§", kcal: 4100 }
                ]
            }
        };

        // --- Advice Database ---
        const adviceList = {
            dog: [
                "æ›é£¼æ–™è«‹éµå®ˆã€Œ7æ—¥æ›é£Ÿæ³•ã€ï¼Œæ¯å¤©å¢åŠ ä¸€é»æ–°é£¼æ–™ï¼Œé¿å…è…¸èƒƒä¸é©ã€‚",
                "é›¶é£Ÿç†±é‡ä¸æ‡‰è¶…éæ¯æ—¥ç¸½ç†±é‡çš„ 10%ï¼Œè¨˜å¾—è¦å¾æ­£é¤æ‰£é™¤å–”ï¼",
                "å¤å¤©æ•£æ­¥è«‹é¿é–‹æ­£ä¸­åˆï¼ŒæŸæ²¹è·¯æº«åº¦éé«˜å¯èƒ½æœƒç‡™å‚·è…³åº•ã€‚",
                "é™¤äº†ä¹¾é£¼æ–™ï¼Œè¨˜å¾—éš¨æ™‚æä¾›ä¹¾æ·¨çš„é£²æ°´ã€‚"
            ],
            cat: [
                "è²“å’ªä¸æ„›å–æ°´å—ï¼Ÿå¯ä»¥å˜—è©¦æµå‹•å¼é£²æ°´æ©Ÿï¼Œæˆ–å¶çˆ¾æ­é…ä¸»é£Ÿç½é¨™æ°´å–ã€‚",
                "è²“å’ªæ˜¯è‚‰é£Ÿæ€§å‹•ç‰©ï¼Œè«‹ç›¡é‡é¿å…ç¢³æ°´åŒ–åˆç‰©éé«˜çš„é›¶é£Ÿã€‚",
                "æ¸›é‡ä¸èƒ½å¤ªå¿«ï¼è²“å’ªå¦‚æœé¤“å¤ªä¹…å®¹æ˜“æœ‰è„‚è‚ªè‚é¢¨éšªï¼Œè«‹å¾ªåºæ¼¸é€²ã€‚",
                "ä¹¾é£¼æ–™é–‹å°å¾Œå»ºè­°å¯†å°ä¿å­˜ï¼Œä¸¦åœ¨ä¸€å€‹æœˆå…§åƒå®Œä»¥å…å—æ½®æ°§åŒ–ã€‚"
            ]
        };

        // --- Functions ---
        
        function initData() {
            const type = document.querySelector('input[name="petType"]:checked').value;
            const currentData = data[type];

            // Populate Breeds
            const breedSelect = document.getElementById('breedSelect');
            breedSelect.innerHTML = '<option value="">-- è«‹é¸æ“‡å“ç¨® (åƒè€ƒé«”é‡) --</option>';
            currentData.breeds.forEach(b => {
                const opt = document.createElement('option');
                opt.value = b.weight;
                opt.text = `${b.name} (ç´„${b.weight}kg)`;
                breedSelect.appendChild(opt);
            });

            // Populate Conditions
            const condSelect = document.getElementById('condition');
            condSelect.innerHTML = '';
            currentData.conditions.forEach(c => {
                const opt = document.createElement('option');
                opt.value = c.val;
                opt.text = c.text;
                condSelect.appendChild(opt);
            });

            // Populate Food Brands
            const foodSelect = document.getElementById('foodBrand');
            foodSelect.innerHTML = '<option value="0">-- æ‰‹å‹•è¼¸å…¥æˆ–é¸æ“‡å“ç‰Œ --</option>';
            currentData.foods.forEach(f => {
                const opt = document.createElement('option');
                opt.value = f.kcal;
                opt.text = f.name;
                foodSelect.appendChild(opt);
            });

            // Change Theme Colors slightly based on pet
            const root = document.documentElement;
            if (type === 'cat') {
                root.style.setProperty('--primary', '#a1c4fd'); // Blueish for cats
                root.style.setProperty('--primary-dark', '#80aefc');
                root.style.setProperty('--secondary', '#e2ebf0');
                root.style.setProperty('--bg', '#f0f7ff');
                root.style.setProperty('--accent', '#FF9A9E');
            } else {
                root.style.setProperty('--primary', '#FF9A9E'); // Pinkish for dogs
                root.style.setProperty('--primary-dark', '#fa7e83');
                root.style.setProperty('--secondary', '#FECFEF');
                root.style.setProperty('--bg', '#FFF0F3');
                root.style.setProperty('--accent', '#a1c4fd');
            }
        }

        function updateWeightFromBreed() {
            const weight = document.getElementById('breedSelect').value;
            if (weight) {
                document.getElementById('weight').value = weight;
                // Animation effect
                const input = document.getElementById('weight');
                input.style.transform = "scale(1.05)";
                setTimeout(() => input.style.transform = "scale(1)", 200);
            }
        }

        function updateCaloriesFromBrand() {
            const kcal = document.getElementById('foodBrand').value;
            if (kcal != "0") {
                document.getElementById('calories').value = kcal;
                const input = document.getElementById('calories');
                input.style.transform = "scale(1.05)";
                setTimeout(() => input.style.transform = "scale(1)", 200);
            }
        }

        function calculate() {
            const weight = parseFloat(document.getElementById('weight').value);
            const factor = parseFloat(document.getElementById('condition').value);
            const kcal = parseFloat(document.getElementById('calories').value);
            const type = document.querySelector('input[name="petType"]:checked').value;

            if (!weight || !kcal) {
                alert("è«‹è¼¸å…¥é«”é‡èˆ‡ç†±é‡è³‡è¨Šå–”ï¼ğŸ¾");
                return;
            }

            // RER Formula
            const rer = 70 * Math.pow(weight, 0.75);
            const der = rer * factor; // Daily Energy Requirement
            
            // Daily Grams
            const totalGrams = (der / kcal) * 1000;

            // Update UI
            document.getElementById('result-card').style.display = 'block';
            
            // Animate Numbers
            animateValue('totalAmount', 0, Math.round(totalGrams), 800);
            document.getElementById('meal2').innerText = Math.round(totalGrams / 2);
            document.getElementById('meal3').innerText = Math.round(totalGrams / 3);
            document.getElementById('totalKcal').innerText = `æ¯æ—¥æ‰€éœ€ç†±é‡ï¼šç´„ ${Math.round(der)} kcal`;

            // Random Advice
            const adviceArray = adviceList[type];
            const randomAdvice = adviceArray[Math.floor(Math.random() * adviceArray.length)];
            document.getElementById('adviceText').innerText = randomAdvice;

            // Scroll to result
            document.getElementById('result-card').scrollIntoView({behavior: 'smooth'});
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // Initialize
        initData();
    </script>
</body>
</html>
