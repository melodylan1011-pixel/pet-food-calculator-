<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯›å­©é£²é£Ÿè¨ˆç®—æ©Ÿ (è±ªè¯ç‰ˆ) ğŸ¾</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF9A9E;
            --primary-dark: #fa7e83;
            --secondary: #FECFEF;
            --accent: #a1c4fd;
            --text: #5D5D5D;
            --bg: #FFF0F3;
            --card-bg: #FFFFFF;
        }

        body {
            font-family: 'Quicksand', 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(#ffdde1 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 30px 15px;
        }

        .container {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 35px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 100%;
            border: 5px solid white;
            position: relative;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin: 0 0 0.5rem 0;
            font-size: 1.8rem;
        }
        
        .subtitle {
            text-align: center;
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 1.5rem;
        }

        /* Image Display Area */
        .pet-image-container {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px auto;
            border-radius: 50%;
            overflow: hidden;
            border: 5px solid var(--secondary);
            background: #f5f5f5;
            position: relative;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .pet-image-container:hover {
            transform: scale(1.05) rotate(3deg);
        }

        #petImage {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .default-emoji {
            font-size: 4rem;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
            background: white;
        }

        /* Toggle Switch */
        .pet-toggle {
            display: flex;
            background: #f0f0f0;
            border-radius: 50px;
            padding: 5px;
            margin-bottom: 20px;
            position: relative;
        }

        .pet-toggle input { display: none; }

        .pet-toggle label {
            flex: 1;
            text-align: center;
            padding: 10px;
            z-index: 2;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            color: #aaa;
            border-radius: 50px;
        }

        .pet-toggle input:checked + label { color: white; }

        .slider {
            position: absolute;
            height: calc(100% - 10px);
            width: calc(50% - 5px);
            background: var(--primary);
            border-radius: 50px;
            top: 5px;
            left: 5px;
            transition: 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 1;
        }

        #cat:checked ~ .slider {
            transform: translateX(100%);
            background: var(--accent);
        }

        /* Forms */
        .section-title {
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 5px;
        }

        select, input {
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 10px;
            border: 2px solid var(--secondary);
            border-radius: 15px;
            font-size: 1rem;
            font-family: inherit;
            background: white;
            box-sizing: border-box;
            outline: none;
            transition: 0.2s;
        }

        select:focus, input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 154, 158, 0.2);
        }

        .input-group { position: relative; }
        .input-suffix {
            position: absolute;
            right: 15px;
            top: 14px;
            color: #999;
            font-size: 0.9rem;
            pointer-events: none;
        }

        button.calc-btn {
            background: linear-gradient(45deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 15px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 1.5rem;
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.4);
            transition: transform 0.2s;
        }

        button.calc-btn:active { transform: scale(0.98); }

        /* Results */
        #result-card {
            background: linear-gradient(135deg, #fff8f9 0%, #fff 100%);
            border: 2px solid var(--secondary);
            padding: 20px;
            border-radius: 25px;
            margin-top: 25px;
            display: none;
            animation: slideUp 0.5s ease;
        }

        .main-result {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px dashed var(--secondary);
            padding-bottom: 15px;
        }

        .big-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
        }

        .meal-plan {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .plan-item {
            background: white;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            flex: 1;
            text-align: center;
        }

        .plan-title { font-size: 0.8rem; color: #999; }
        .plan-val { font-weight: bold; color: var(--text); }

        .advice-box {
            margin-top: 20px;
            background: #F0F7FF;
            padding: 15px;
            border-radius: 15px;
            border-left: 4px solid #5B86E5;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Mobile Fix */
        @media (max-width: 400px) {
            .container { padding: 1.5rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>æ¯›å­©é£²é£Ÿç®¡å®¶ ğŸ¾</h1>
        <p class="subtitle">é¸æ“‡å“ç¨®çœ‹ç…§ç‰‡ï¼Œä¸€éµè¨ˆç®—å¥åº·é£Ÿé‡</p>

        <!-- Image Area -->
        <div class="pet-image-container">
            <div id="defaultEmoji" class="default-emoji">ğŸ¶</div>
            <img id="petImage" src="" alt="Pet Image" style="display: none;">
        </div>

        <!-- Pet Switcher -->
        <div class="pet-toggle">
            <input type="radio" id="dog" name="petType" value="dog" checked onchange="initData()">
            <label for="dog">ç‹—ç‹—</label>
            <input type="radio" id="cat" name="petType" value="cat" onchange="initData()">
            <label for="cat">è²“å’ª</label>
            <div class="slider"></div>
        </div>

        <!-- Inputs -->
        <div class="section-title">ğŸ§¬ é¸æ“‡å“ç¨® (è‡ªå‹•å¸¶å…¥é«”é‡)</div>
        <select id="breedSelect" onchange="updateBreedInfo()">
            <option value="">-- è«‹é¸æ“‡å“ç¨® --</option>
        </select>

        <div class="section-title">âš–ï¸ é«”é‡ (kg)</div>
        <div class="input-group">
            <input type="number" id="weight" placeholder="è¼¸å…¥å¯¦éš›é«”é‡" step="0.1">
            <span class="input-suffix">kg</span>
        </div>

        <div class="section-title">ğŸƒ ç”Ÿå‘½éšæ®µ / æ´»å‹•é‡</div>
        <select id="condition">
            <!-- JS Populated -->
        </select>

        <div class="section-title">ğŸ¥« é¸æ“‡é£¼æ–™å“ç‰Œ</div>
        <select id="foodBrand" onchange="updateCaloriesFromBrand()">
            <option value="0">-- æ‰‹å‹•è¼¸å…¥æˆ–é¸æ“‡å“ç‰Œ --</option>
            <!-- JS Populated -->
        </select>

        <div class="section-title">ğŸ”¥ ç†±é‡ (kcal/kg)</div>
        <div class="input-group">
            <input type="number" id="calories" placeholder="åŒ…è£èƒŒé¢çš„ä»£è¬èƒ½(ME)">
            <span class="input-suffix">kcal/kg</span>
        </div>

        <button class="calc-btn" onclick="calculate()">è¨ˆç®—å»ºè­°é£Ÿé‡ âœ¨</button>

        <!-- Result -->
        <div id="result-card">
            <div class="main-result">
                <div style="font-size:0.9rem; color:#888;">å»ºè­°æ¯æ—¥ç¸½é‡</div>
                <span class="big-number" id="totalAmount">0</span> <span style="color:#888">g</span>
                <div style="font-size: 0.8rem; color: var(--primary);" id="totalKcal"></div>
            </div>

            <div class="meal-plan">
                <div class="plan-item">
                    <div class="plan-title">æ—©æ™šå…©é¤åˆ¶</div>
                    <div class="plan-val"><span id="meal2">0</span> g/é¤</div>
                </div>
                <div class="plan-item">
                    <div class="plan-title">å°‘é‡ä¸‰é¤åˆ¶</div>
                    <div class="plan-val"><span id="meal3">0</span> g/é¤</div>
                </div>
            </div>

            <div class="advice-box">
                <strong>ğŸ’¡ ç¸é†«å°å®åš€ï¼š</strong><br>
                <span id="adviceText"></span>
            </div>
        </div>
    </div>

    <script>
        // --- å¤§é‡æ“´å……çš„è³‡æ–™åº« (åŒ…å«åœ–ç‰‡é€£çµ) ---
        // åœ–ç‰‡ä½¿ç”¨ Wikimedia Commons æˆ–ç©©å®šçš„åœ–åº«é€£çµ
        const data = {
            dog: {
                breeds: [
                    { name: "ç±³å…‹æ–¯ (æ··ç¨®)", weight: 15, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/Taiwan_Dog_2.jpg/500px-Taiwan_Dog_2.jpg" },
                    { name: "è²´è³“çŠ¬ (ç©å…·å‹)", weight: 3.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Full_attention_%288067543690%29.jpg/500px-Full_attention_%288067543690%29.jpg" },
                    { name: "æŸ´çŠ¬", weight: 10, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/Taka_Shiba.jpg/500px-Taka_Shiba.jpg" },
                    { name: "é¦¬çˆ¾æ¿Ÿæ–¯", weight: 2.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/94/Maltese_600.jpg/500px-Maltese_600.jpg" },
                    { name: "æŸ¯åŸº", weight: 12, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Welsh_Corgi_Pembroke.jpg/500px-Welsh_Corgi_Pembroke.jpg" },
                    { name: "é»ƒé‡‘çµçŠ¬", weight: 30, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/bd/Golden_Retriever_Dukedestiny01_drvd.jpg/500px-Golden_Retriever_Dukedestiny01_drvd.jpg" },
                    { name: "æ‹‰ä¸æ‹‰å¤š", weight: 32, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/26/YellowLabradorLooking_new.jpg/500px-YellowLabradorLooking_new.jpg" },
                    { name: "æ³•åœ‹é¬¥ç‰›çŠ¬", weight: 11, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/2008-07-28_Dog_at_Frolick_Field.jpg/500px-2008-07-28_Dog_at_Frolick_Field.jpg" },
                    { name: "é•·æ¯›è‡˜è…¸çŠ¬", weight: 5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/Short_haired_Dachshund.jpg/500px-Short_haired_Dachshund.jpg" },
                    { name: "åšç¾çŠ¬", weight: 2.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Pomeranian.JPG/500px-Pomeranian.JPG" },
                    { name: "å‰å¨ƒå¨ƒ", weight: 2, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Chihuahua1_bvdb.jpg/500px-Chihuahua1_bvdb.jpg" },
                    { name: "é›ªç´ç‘ (è¿·ä½ )", weight: 7, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/93/Miniature_Schnauzer_Rony_2012.jpg/500px-Miniature_Schnauzer_Rony_2012.jpg" },
                    { name: "æ¯”æ ¼çŠ¬ (ç±³æ ¼é­¯)", weight: 10, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Beagle_600.jpg/500px-Beagle_600.jpg" },
                    { name: "é‚Šå¢ƒç‰§ç¾ŠçŠ¬", weight: 18, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Border_Collie_600.jpg/500px-Border_Collie_600.jpg" },
                    { name: "å“ˆå£«å¥‡", weight: 23, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Siberian_Husky_bi-eyed_Flickr.jpg/500px-Siberian_Husky_bi-eyed_Flickr.jpg" },
                    { name: "æ¯”ç†ŠçŠ¬", weight: 5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/93/Bichon_Fris%C3%A9_-_studiocanal.jpg/500px-Bichon_Fris%C3%A9_-_studiocanal.jpg" },
                    { name: "ç´„å…‹å¤", weight: 3, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/A_Yorkshire_Terrier_in_Needham.jpg/500px-A_Yorkshire_Terrier_in_Needham.jpg" }
                ],
                conditions: [
                    { val: 1.6, text: "æˆçŠ¬ (å·²çµç´®/ä¸€èˆ¬)" },
                    { val: 1.8, text: "æˆçŠ¬ (æœªçµç´®/æ´»æ½‘)" },
                    { val: 3.0, text: "å¹¼çŠ¬ (4å€‹æœˆä»¥ä¸‹)" },
                    { val: 2.0, text: "å¹¼çŠ¬ (æˆé•·ä¸­)" },
                    { val: 1.0, text: "è€çŠ¬ / éœ€æ¸›é‡ / æ˜“èƒ–" },
                    { val: 2.0, text: "é«˜æ´»å‹•é‡ (å·¥ä½œçŠ¬/å¸¸é‹å‹•)" }
                ],
                foods: [
                    { name: "Royal Canin çš‡å®¶ - å°å‹æˆçŠ¬", kcal: 3960 },
                    { name: "Royal Canin çš‡å®¶ - é»ƒé‡‘çµçŠ¬å°ˆç”¨", kcal: 3620 },
                    { name: "Orijen æ¸´æœ› - åŸå‘³é®®é› (é«˜è›‹ç™½)", kcal: 3960 },
                    { name: "Orijen æ¸´æœ› - å…­ç¨®é­š", kcal: 3860 },
                    { name: "Real Power ç‘å¨ - 1è™Ÿè‰åŸç¾Š", kcal: 4050 },
                    { name: "Real Power ç‘å¨ - 2è™Ÿæ£®æ—ç‡‰é›", kcal: 3950 },
                    { name: "Hill's å¸Œçˆ¾æ€ - æˆçŠ¬é›è‚‰", kcal: 3650 },
                    { name: "Hill's å¸Œçˆ¾æ€ - å®Œç¾é«”æ…‹(æ¸›è‚¥)", kcal: 3200 },
                    { name: "Acana æ„›è‚¯æ‹¿ - å–®ä¸€è›‹ç™½é´¨è‚‰", kcal: 3393 },
                    { name: "Taste of the Wild æµ·é™¸é¥—å®´ - å¤ªå¹³æ´‹ç‡»é®­", kcal: 3600 },
                    { name: "Farmina æ³•ç±³ç´ - å—ç“œç„¡ç©€ç¾Šè‚‰", kcal: 3960 },
                    { name: "Blackwood æŸèŠå¯Œ - ç‰¹èª¿é›è‚‰", kcal: 3800 },
                    { name: "ZiwiPeak å·”å³° - ç¾Šè‚‰è‚‰ä¹¾ (é«˜ç†±é‡)", kcal: 5600 }
                ]
            },
            cat: {
                breeds: [
                    { name: "ç±³å…‹æ–¯ (ä¸€èˆ¬)", weight: 4.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Kittyply_edit1.jpg/500px-Kittyply_edit1.jpg" },
                    { name: "ç¾åœ‹çŸ­æ¯›è²“", weight: 5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/American_Shorthair.jpg/500px-American_Shorthair.jpg" },
                    { name: "è‹±åœ‹çŸ­æ¯›è²“", weight: 5.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/9d/Britishblue.jpg/500px-Britishblue.jpg" },
                    { name: "å¸ƒå¶è²“", weight: 6.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/64/Ragdoll_from_Gatil_Ragbelas.jpg/500px-Ragdoll_from_Gatil_Ragbelas.jpg" },
                    { name: "è³“å£«è²“ (ç±³å…‹æ–¯)", weight: 4.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Tuxedo_Cat_-_Socks_-_02.jpg/500px-Tuxedo_Cat_-_Socks_-_02.jpg" },
                    { name: "æ©˜è²“ (æ˜“èƒ–)", weight: 5.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/Johnny_Automatic_standing_cat.svg/500px-Johnny_Automatic_standing_cat.svg.png" }, 
                    { name: "æ³¢æ–¯è²“", weight: 4, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/White_Persian_Cat.jpg/500px-White_Persian_Cat.jpg" },
                    { name: "æ›¼èµ¤è‚¯ (çŸ­è…¿)", weight: 3.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/64/Munchkin_cat_puffy.jpg/500px-Munchkin_cat_puffy.jpg" },
                    { name: "æš¹ç¾…è²“", weight: 3.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/25/Siam_lilacpoint.jpg/500px-Siam_lilacpoint.jpg" },
                    { name: "ç·¬å› è²“", weight: 7.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Maine_Coon_cat_by_Tomtheman5.jpg/500px-Maine_Coon_cat_by_Tomtheman5.jpg" },
                    { name: "ä¿„ç¾…æ–¯è—è²“", weight: 4, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/Russian_Blue_Cat.jpg/500px-Russian_Blue_Cat.jpg" },
                    { name: "ç„¡æ¯›è²“ (æ–¯èŠ¬å…‹æ–¯)", weight: 4, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e8/Sphinx2_July_2006.jpg/500px-Sphinx2_July_2006.jpg" },
                    { name: "ç•°åœ‹çŸ­æ¯›è²“ (åŠ è²)", weight: 4.5, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Exotic_Shorthair.JPG/500px-Exotic_Shorthair.JPG" }
                ],
                conditions: [
                    { val: 1.2, text: "æˆè²“ (å·²çµç´®/å®¤å…§)" },
                    { val: 1.4, text: "æˆè²“ (æœªçµç´®/æ´»èº)" },
                    { val: 2.5, text: "å¹¼è²“ (æˆé•·ä¸­)" },
                    { val: 0.8, text: "æ¸›é‡ä¸­ / è‚¥èƒ–" },
                    { val: 1.0, text: "è€è²“ (æ´»å‹•åŠ›ä½)" },
                    { val: 1.6, text: "æ‡·å­• / å“ºä¹³æœŸ" }
                ],
                foods: [
                    { name: "Royal Canin çš‡å®¶ - å®¤å…§è²“", kcal: 3750 },
                    { name: "Royal Canin çš‡å®¶ - æ³Œå°¿é“é…æ–¹", kcal: 3870 },
                    { name: "Orijen æ¸´æœ› - é®®é›æ„›è²“ (é«˜è›‹ç™½)", kcal: 4060 },
                    { name: "Orijen æ¸´æœ› - å…­ç¨®é­š", kcal: 4060 },
                    { name: "Real Power ç‘å¨ - 3è™Ÿæµ·é­š", kcal: 4150 },
                    { name: "Wellness CORE - ç„¡ç©€æˆè²“", kcal: 3977 },
                    { name: "GO! - å››ç¨®è‚‰ (é«˜è‚‰é‡)", kcal: 4298 },
                    { name: "NOW! - é®®è‚‰ç„¡ç©€æˆè²“", kcal: 3784 },
                    { name: "Farmina æ³•ç±³ç´ - è‘‰é…¸é´¨è‚‰", kcal: 4060 },
                    { name: "Instinct åŸé» - é›è‚‰ç„¡ç©€", kcal: 4150 },
                    { name: "Mobby è«æ¯” - ç„¡ç©€é¹¿è‚‰", kcal: 3650 },
                    { name: "Nutram ç´é “ - T22 ç„¡ç©€ç«é›", kcal: 3820 },
                    { name: "æ€ªç¸éƒ¨è½ - 98% é®®è‚‰ç³§", kcal: 4100 }
                ]
            }
        };

        const adviceList = {
            dog: [
                "ç‹—ç‹—çš„èƒƒåƒå€‹ç„¡åº•æ´ï¼Ÿè«‹ä¾ç…§ BCS é«”æ…‹è©•åˆ†è¡¨ï¼Œè‹¥æ‘¸ä¸åˆ°è‚‹éª¨å°±æ˜¯å¤ªèƒ–å›‰ï¼",
                "æ›é£¼æ–™è¦èŠ± 7-10 å¤©æ…¢æ…¢æ›¿æ›ï¼Œé¿å…çªç„¶æ‹‰è‚šå­ã€‚",
                "è‘¡è„ã€å·§å…‹åŠ›ã€æ´‹è”¥æ˜¯ç‹—ç‹—çš„åŠ‡æ¯’ï¼Œåƒè¬å°å¿ƒï¼",
                "å¤å¤©æŸæ²¹è·¯è¶…ç‡™ï¼è«‹ç”¨æ‰‹èƒŒæ¸¬æº«ï¼Œæœƒç‡™æ‰‹å°±æœƒç‡™è…³ã€‚",
                "æ¯å¤©è¶³å¤ çš„æ•£æ­¥ä¸åªèƒ½æ¶ˆè€—ç†±é‡ï¼Œé‚„èƒ½ç©©å®šç‹—ç‹—æƒ…ç·’å–”ï¼"
            ],
            cat: [
                "è²“å’ªä¸æ„›å–æ°´ï¼Ÿè©¦è©¦çœ‹æ”¾å¹¾å€‹æ°´æ¯åœ¨å®¶è£¡ä¸åŒè§’è½ï¼Œæˆ–æ˜¯ä½¿ç”¨æµå‹•é£²æ°´æ©Ÿã€‚",
                "è²“å’ªæ¸›è‚¥ä¸èƒ½ã€æ–·é£Ÿã€ï¼é•·æ™‚é–“ä¸åƒæ±è¥¿å®¹æ˜“å¼•ç™¼è„‚è‚ªè‚ï¼Œéå¸¸å±éšªã€‚",
                "ä¹¾é£¼æ–™é–‹å°å¾Œå®¹æ˜“å—æ½®ï¼Œå»ºè­°åˆ†è£ä¸¦åœ¨ä¸€å€‹æœˆå…§åƒå®Œã€‚",
                "å…¬è²“å®¹æ˜“æœ‰æ³Œå°¿é“å•é¡Œï¼Œè‹¥ç™¼ç¾é »ç¹é€²è²“ç ‚ç›†å»å°¿ä¸å‡ºä¾†ï¼Œè«‹ç«‹åˆ»å°±é†«ï¼",
                "ç™¾åˆèŠ±å°è²“å’ªæœ‰åŠ‡æ¯’ï¼Œå®¶è£¡è«‹çµ•å°é¿å…ç¨®æ¤ã€‚"
            ]
        };

        // --- Functions ---

        function initData() {
            const type = document.querySelector('input[name="petType"]:checked').value;
            const currentData = data[type];
            const root = document.documentElement;
            const emojiDiv = document.getElementById('defaultEmoji');
            
            // Reset Image
            document.getElementById('petImage').style.display = 'none';
            emojiDiv.style.display = 'flex';
            emojiDiv.innerText = type === 'dog' ? 'ğŸ¶' : 'ğŸ±';

            // Populate Breeds
            const breedSelect = document.getElementById('breedSelect');
            breedSelect.innerHTML = '<option value="">-- è«‹é¸æ“‡å“ç¨® --</option>';
            currentData.breeds.forEach((b, index) => {
                const opt = document.createElement('option');
                opt.value = index; // Use index to locate full object later
                opt.text = `${b.name}`;
                breedSelect.appendChild(opt);
            });

            // Populate Conditions
            const condSelect = document.getElementById('condition');
            condSelect.innerHTML = '';
            currentData.conditions.forEach(c => {
                const opt = document.createElement('option');
                opt.value = c.val;
                opt.text = c.text;
                condSelect.appendChild(opt);
            });

            // Populate Foods
            const foodSelect = document.getElementById('foodBrand');
            foodSelect.innerHTML = '<option value="0">-- æ‰‹å‹•è¼¸å…¥æˆ–é¸æ“‡å“ç‰Œ --</option>';
            currentData.foods.forEach(f => {
                const opt = document.createElement('option');
                opt.value = f.kcal;
                opt.text = f.name;
                foodSelect.appendChild(opt);
            });

            // Color Theme Switch
            if (type === 'cat') {
                root.style.setProperty('--primary', '#a1c4fd');
                root.style.setProperty('--primary-dark', '#80aefc');
                root.style.setProperty('--secondary', '#e2ebf0');
                root.style.setProperty('--bg', '#f0f7ff');
                root.style.setProperty('--accent', '#FF9A9E');
            } else {
                root.style.setProperty('--primary', '#FF9A9E');
                root.style.setProperty('--primary-dark', '#fa7e83');
                root.style.setProperty('--secondary', '#FECFEF');
                root.style.setProperty('--bg', '#FFF0F3');
                root.style.setProperty('--accent', '#a1c4fd');
            }
        }

        function updateBreedInfo() {
            const type = document.querySelector('input[name="petType"]:checked').value;
            const index = document.getElementById('breedSelect').value;
            const imgEl = document.getElementById('petImage');
            const emojiEl = document.getElementById('defaultEmoji');
            const weightInput = document.getElementById('weight');

            if (index !== "") {
                const breedData = data[type].breeds[index];
                
                // Update Weight
                weightInput.value = breedData.weight;
                weightInput.style.transform = "scale(1.05)";
                setTimeout(() => weightInput.style.transform = "scale(1)", 200);

                // Update Image
                if (breedData.img) {
                    imgEl.src = breedData.img;
                    imgEl.style.display = 'block';
                    emojiEl.style.display = 'none';
                } else {
                    imgEl.style.display = 'none';
                    emojiEl.style.display = 'flex';
                }
            } else {
                imgEl.style.display = 'none';
                emojiEl.style.display = 'flex';
            }
        }

        function updateCaloriesFromBrand() {
            const kcal = document.getElementById('foodBrand').value;
            if (kcal != "0") {
                document.getElementById('calories').value = kcal;
                const input = document.getElementById('calories');
                input.style.transform = "scale(1.05)";
                setTimeout(() => input.style.transform = "scale(1)", 200);
            }
        }

        function calculate() {
            const weight = parseFloat(document.getElementById('weight').value);
            const factor = parseFloat(document.getElementById('condition').value);
            const kcal = parseFloat(document.getElementById('calories').value);
            const type = document.querySelector('input[name="petType"]:checked').value;

            if (!weight || !kcal) {
                alert("è«‹ç¢ºä¿é«”é‡èˆ‡ç†±é‡éƒ½å·²å¡«å¯«å–”ï¼ğŸ¾");
                return;
            }

            // RER = 70 * (Weight ^ 0.75)
            const rer = 70 * Math.pow(weight, 0.75);
            const der = rer * factor;
            const totalGrams = (der / kcal) * 1000;

            document.getElementById('result-card').style.display = 'block';
            
            // Count Up Animation
            animateValue('totalAmount', 0, Math.round(totalGrams), 800);
            
            document.getElementById('meal2').innerText = Math.round(totalGrams / 2);
            document.getElementById('meal3').innerText = Math.round(totalGrams / 3);
            document.getElementById('totalKcal').innerText = `(æ¯æ—¥æ‰€éœ€ç†±é‡: ç´„${Math.round(der)} kcal)`;

            // Random Advice
            const adviceArr = adviceList[type];
            document.getElementById('adviceText').innerText = adviceArr[Math.floor(Math.random() * adviceArr.length)];

            document.getElementById('result-card').scrollIntoView({behavior: 'smooth'});
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // Init
        initData();
    </script>
</body>
</html>
