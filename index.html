<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŒå¯µé£²é£Ÿè¨ˆç®—æ©Ÿ (å‹•åœ–ç‰ˆ) ğŸ¾</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600;700&family=Noto+Sans+TC:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF8BA0; /* ç‹—ç‹—ç²‰ */
            --primary-dark: #FF6B85;
            --secondary: #FFE4E9;
            --bg: #FFF5F7;
            --text: #6B5B5B;
            --card-bg: #FFFFFF;
        }

        body {
            font-family: 'Quicksand', 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            transition: background-color 0.5s;
        }

        .container {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 40px;
            box-shadow: 0 20px 40px rgba(255, 139, 160, 0.15);
            max-width: 450px;
            width: 100%;
            border: 8px solid white;
            position: relative;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin: 0 0 5px 0;
            font-size: 1.8rem;
        }

        .subtitle {
            text-align: center;
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 25px;
        }

        /* --- å¤§åˆ‡æ›æŒ‰éˆ• --- */
        .toggle-container {
            display: flex;
            background: #F0F0F0;
            border-radius: 60px;
            padding: 6px;
            position: relative;
            margin-bottom: 30px;
            cursor: pointer;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }

        .toggle-btn {
            flex: 1;
            text-align: center;
            padding: 12px;
            font-size: 1.1rem;
            font-weight: bold;
            z-index: 2;
            color: #aaa;
            transition: 0.3s;
            user-select: none;
        }

        .toggle-btn.active {
            color: white;
        }

        .toggle-slider {
            position: absolute;
            width: calc(50% - 6px);
            height: calc(100% - 12px);
            top: 6px;
            left: 6px;
            background: var(--primary);
            border-radius: 50px;
            transition: 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 1;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        /* è²“å’ªæ¨¡å¼çš„é¡è‰² */
        body.cat-mode { --bg: #F0F8FF; }
        body.cat-mode .container { box-shadow: 0 20px 40px rgba(139, 190, 255, 0.15); }
        body.cat-mode .toggle-slider { background: #89C4FF; left: calc(50%); }
        body.cat-mode h1 { color: #89C4FF; }
        body.cat-mode .calc-btn { background: #89C4FF; }
        body.cat-mode .big-number { color: #89C4FF; }

        /* --- è¼¸å…¥è¡¨å–® --- */
        label {
            display: block;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 8px;
            margin-top: 15px;
            color: var(--text);
        }

        input, select {
            width: 100%;
            padding: 15px;
            border: 2px solid #F0F0F0;
            border-radius: 20px;
            font-size: 1rem;
            background: #FAFAFA;
            box-sizing: border-box;
            outline: none;
            transition: 0.3s;
            font-family: inherit;
        }

        input:focus, select:focus {
            border-color: var(--primary);
            background: white;
        }
        body.cat-mode input:focus, body.cat-mode select:focus { border-color: #89C4FF; }

        .calc-btn {
            width: 100%;
            padding: 18px;
            margin-top: 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        .calc-btn:active { transform: scale(0.98); }

        /* --- çµæœé¡¯ç¤ºå€ --- */
        #result-area {
            margin-top: 30px;
            border-top: 3px dashed #eee;
            padding-top: 20px;
            display: none; /* é è¨­éš±è— */
            animation: slideUp 0.5s ease;
        }

        .result-box {
            text-align: center;
            margin-bottom: 20px;
        }

        .big-number {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
        }

        .unit { font-size: 1rem; color: #aaa; font-weight: bold; }

        .meals {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .meal-card {
            flex: 1;
            background: #F8F9FA;
            padding: 10px;
            border-radius: 15px;
            text-align: center;
        }
        .meal-card div:first-child { font-size: 0.8rem; color: #bbb; margin-bottom: 5px; }
        .meal-card div:last-child { font-weight: bold; font-size: 1.1rem; color: #666; }

        /* --- èµ°è·¯å‹•ç•«å€ (é‡é») --- */
        .runway {
            height: 100px;
            background: transparent;
            position: relative;
            overflow: hidden;
            border-radius: 20px;
            background: linear-gradient(to bottom, transparent 60%, #eee 60%, #eee 62%, transparent 62%);
        }

        .pet-runner {
            width: 80px;
            height: 80px;
            position: absolute;
            bottom: 25px; /* èª¿æ•´ä½ç½®è®“å®ƒå‰›å¥½è¸©åœ¨ç·šä¸Š */
            left: -100px;
            animation: run 4s linear infinite;
        }

        .pet-runner img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        @keyframes run {
            0% { left: -20%; transform: scaleX(1); }
            45% { left: 110%; transform: scaleX(1); }
            50% { left: 110%; transform: scaleX(-1); } /* è½‰èº« */
            100% { left: -20%; transform: scaleX(-1); } /* è·‘å›å» */
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>æ¯›å­©é£¯é£¯è¨ˆç®—æ©Ÿ</h1>
        <p class="subtitle">é¸æ“‡ç¨®é¡ ğŸ‘‰ è¼¸å…¥é«”é‡ ğŸ‘‰ ç²å¾—é£Ÿé‡</p>

        <!-- åˆ‡æ›é–‹é—œ -->
        <div class="toggle-container" onclick="togglePet()">
            <div class="toggle-slider"></div>
            <div class="toggle-btn active" id="btn-dog">ğŸ¶ ç‹—ç‹—</div>
            <div class="toggle-btn" id="btn-cat">ğŸ± è²“å’ª</div>
        </div>

        <!-- è¼¸å…¥å€ -->
        <label>âš–ï¸ é«”é‡ (å…¬æ–¤/kg)</label>
        <input type="number" id="weight" placeholder="ä¾‹å¦‚ï¼š5.2" step="0.1">

        <label>ğŸƒ ç”Ÿå‘½éšæ®µ / ç‹€æ…‹</label>
        <select id="condition">
            <!-- JS å‹•æ…‹å¡«å…¥ -->
        </select>

        <label>ğŸ¥« é£¼æ–™ç†±é‡ (kcal/kg)</label>
        <div style="display:flex; gap:5px;">
            <input type="number" id="calories" placeholder="ç¿»åˆ°é£¼æ–™è¢‹èƒŒé¢æ‰¾ ME">
            <select id="quick-food" onchange="fillCalories()" style="width: 40%; background: #fff;">
                <option value="0">å¿«é€Ÿé¸æ“‡</option>
                <!-- JS å‹•æ…‹å¡«å…¥ -->
            </select>
        </div>

        <button class="calc-btn" onclick="calculate()">è¨ˆç®—å»ºè­°é£Ÿé‡ âœ¨</button>

        <!-- çµæœå€ -->
        <div id="result-area">
            <div class="result-box">
                <div style="margin-bottom:5px; color:#aaa">å»ºè­°æ¯æ—¥ç¸½é‡</div>
                <span class="big-number" id="totalAmount">0</span> <span class="unit">g</span>
            </div>

            <div class="meals">
                <div class="meal-card">
                    <div>æ—©æ™šå…©é¤</div>
                    <div id="meal2">0 g</div>
                </div>
                <div class="meal-card">
                    <div>ä¸‰é¤åˆ¶</div>
                    <div id="meal3">0 g</div>
                </div>
            </div>

            <!-- é‡é»å‹•ç•« -->
            <div class="runway">
                <div class="pet-runner">
                    <img id="pet-gif" src="" alt="running pet">
                </div>
            </div>
            <div style="text-align:center; font-size:0.8rem; color:#bbb; margin-top:5px;">
                (çµæœåƒ…ä¾›åƒè€ƒï¼Œè«‹ä¾å¯¦éš›é«”æ…‹èª¿æ•´)
            </div>
        </div>
    </div>

    <script>
        let currentPet = 'dog';

        // é€™äº›æ˜¯é€æ˜èƒŒæ™¯çš„å¯æ„›å‹•åœ– (GIF)
        const images = {
            dog: "https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExZ3V4MmY1c3R6eHd6eHl6eHl6eHl6eHl6eHl6eHl6eHl6eHl6/Ph0oIVQeuvh0iHRaXh/giphy.gif", // å¥”è·‘çš„æŸ¯åŸº/ç‹—ç‹—
            cat: "https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExY2F0Y2F0Y2F0Y2F0Y2F0Y2F0Y2F0Y2F0Y2F0Y2F0Y2F0/GeimqsH0TLDt4tScGw/giphy.gif" // èµ°è·¯çš„è²“è²“
        };

        const data = {
            dog: {
                conditions: [
                    { val: 1.6, text: "æˆçŠ¬ (å·²çµç´®/ä¸€èˆ¬)" },
                    { val: 1.8, text: "æˆçŠ¬ (æœªçµç´®/æ´»æ½‘)" },
                    { val: 3.0, text: "å¹¼çŠ¬ (4å€‹æœˆä»¥ä¸‹)" },
                    { val: 2.0, text: "å¹¼çŠ¬ (ç™¼è‚²ä¸­)" },
                    { val: 1.0, text: "èƒ–ç‹—ç‹— (æ¸›é‡ä¸­)" },
                    { val: 1.2, text: "è€ç‹— (å°‘å‹•)" }
                ],
                foods: [
                    { name: "çš‡å®¶ å°å‹çŠ¬", kcal: 3960 },
                    { name: "Orijen æ¸´æœ›", kcal: 3960 },
                    { name: "å¸Œçˆ¾æ€ æˆçŠ¬", kcal: 3650 },
                    { name: "ç‘å¨ è‰åŸç¾Š", kcal: 4050 }
                ]
            },
            cat: {
                conditions: [
                    { val: 1.2, text: "æˆè²“ (å·²çµç´®/å®¤å…§)" },
                    { val: 1.4, text: "æˆè²“ (å¥½å‹•)" },
                    { val: 2.5, text: "å¹¼è²“ (å°è²“)" },
                    { val: 0.8, text: "èƒ–è²“ (æ¸›é‡ä¸­)" },
                    { val: 1.6, text: "æ‡·å­•è²“åª½å’ª" }
                ],
                foods: [
                    { name: "çš‡å®¶ å®¤å…§è²“", kcal: 3750 },
                    { name: "Orijen é®®é›", kcal: 4060 },
                    { name: "æ¸´æœ› å…­ç¨®é­š", kcal: 4060 },
                    { name: "è«æ¯” ç„¡ç©€", kcal: 3650 }
                ]
            }
        };

        function togglePet() {
            currentPet = currentPet === 'dog' ? 'cat' : 'dog';
            
            // UI åˆ‡æ›
            const btnDog = document.getElementById('btn-dog');
            const btnCat = document.getElementById('btn-cat');
            const body = document.body;

            if (currentPet === 'cat') {
                btnDog.classList.remove('active');
                btnCat.classList.add('active');
                body.classList.add('cat-mode');
            } else {
                btnCat.classList.remove('active');
                btnDog.classList.add('active');
                body.classList.remove('cat-mode');
            }

            initOptions();
            // éš±è—çµæœç›´åˆ°é‡æ–°è¨ˆç®—
            document.getElementById('result-area').style.display = 'none';
        }

        function initOptions() {
            const d = data[currentPet];
            
            // ç‹€æ…‹é¸å–®
            const condSelect = document.getElementById('condition');
            condSelect.innerHTML = '';
            d.conditions.forEach(c => {
                const opt = document.createElement('option');
                opt.value = c.val;
                opt.innerText = c.text;
                condSelect.appendChild(opt);
            });

            // é£¼æ–™å¿«é€Ÿé¸å–®
            const foodSelect = document.getElementById('quick-food');
            foodSelect.innerHTML = '<option value="0">å¿«é€Ÿé¸æ“‡å“ç‰Œ</option>';
            d.foods.forEach(f => {
                const opt = document.createElement('option');
                opt.value = f.kcal;
                opt.innerText = f.name;
                foodSelect.appendChild(opt);
            });
        }

        function fillCalories() {
            const val = document.getElementById('quick-food').value;
            if(val != "0") {
                document.getElementById('calories').value = val;
            }
        }

        function calculate() {
            const weight = parseFloat(document.getElementById('weight').value);
            const factor = parseFloat(document.getElementById('condition').value);
            const kcal = parseFloat(document.getElementById('calories').value);

            if(!weight || !kcal) {
                alert("è«‹è¼¸å…¥é«”é‡å’Œç†±é‡å–”ï¼");
                return;
            }

            // è¨ˆç®—å…¬å¼
            const rer = 70 * Math.pow(weight, 0.75);
            const der = rer * factor;
            const grams = (der / kcal) * 1000;

            // é¡¯ç¤ºçµæœ
            document.getElementById('result-area').style.display = 'block';
            
            // æ•¸å­—è·³å‹•å‹•ç•«
            animateValue('totalAmount', 0, Math.round(grams), 500);
            document.getElementById('meal2').innerText = Math.round(grams/2) + " g";
            document.getElementById('meal3').innerText = Math.round(grams/3) + " g";

            // è¨­å®šè·‘æ­¥å‹•ç•«
            const gif = document.getElementById('pet-gif');
            gif.src = images[currentPet];

            // æ»¾å‹•åˆ°çµæœ
            setTimeout(() => {
                document.getElementById('result-area').scrollIntoView({behavior: 'smooth'});
            }, 100);
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // åˆå§‹åŒ–
        initOptions();
    </script>
</body>
</html>
